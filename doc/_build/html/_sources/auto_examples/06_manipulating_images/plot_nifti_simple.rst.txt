
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/06_manipulating_images/plot_nifti_simple.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_06_manipulating_images_plot_nifti_simple.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_06_manipulating_images_plot_nifti_simple.py:


Simple example of NiftiMasker use
==================================

Here is a simple example of automatic mask computation using the nifti masker.
The mask is computed and visualized.

.. include:: ../../../examples/masker_note.rst

.. GENERATED FROM PYTHON SOURCE LINES 13-14

Retrieve the brain development functional dataset

.. GENERATED FROM PYTHON SOURCE LINES 14-22

.. code-block:: default


    from nilearn import datasets
    dataset = datasets.fetch_development_fmri(n_subjects=1)
    func_filename = dataset.func[0]

    # print basic information on the dataset
    print('First functional nifti image (4D) is at: %s' % func_filename)


.. GENERATED FROM PYTHON SOURCE LINES 23-24

Compute the mask

.. GENERATED FROM PYTHON SOURCE LINES 24-35

.. code-block:: default

    from nilearn.maskers import NiftiMasker

    # As this is raw movie watching based EPI, the background is noisy and we
    # cannot rely on the 'background' masking strategy. We need to use the 'epi'
    # one
    nifti_masker = NiftiMasker(standardize=True, mask_strategy='epi',
                               memory="nilearn_cache", memory_level=2,
                               smoothing_fwhm=8)
    nifti_masker.fit(func_filename)
    mask_img = nifti_masker.mask_img_


.. GENERATED FROM PYTHON SOURCE LINES 36-37

Visualize the mask using the plot_roi method

.. GENERATED FROM PYTHON SOURCE LINES 37-45

.. code-block:: default

    from nilearn.plotting import plot_roi
    from nilearn.image.image import mean_img

    # calculate mean image for the background
    mean_func_img = mean_img(func_filename)

    plot_roi(mask_img, mean_func_img, display_mode='y', cut_coords=4, title="Mask")


.. GENERATED FROM PYTHON SOURCE LINES 46-50

Visualize the mask using the 'generate_report' method
This report can be displayed in a Jupyter Notebook,
opened in-browser using the .open_in_browser() method,
or saved to a file using the .save_as_html(output_filepath) method.

.. GENERATED FROM PYTHON SOURCE LINES 50-53

.. code-block:: default

    report = nifti_masker.generate_report()
    report


.. GENERATED FROM PYTHON SOURCE LINES 54-55

Preprocess data with the NiftiMasker

.. GENERATED FROM PYTHON SOURCE LINES 55-59

.. code-block:: default

    nifti_masker.fit(func_filename)
    fmri_masked = nifti_masker.transform(func_filename)
    # fmri_masked is now a 2D matrix, (n_voxels x n_time_points)


.. GENERATED FROM PYTHON SOURCE LINES 60-61

Run an algorithm

.. GENERATED FROM PYTHON SOURCE LINES 61-66

.. code-block:: default

    from sklearn.decomposition import FastICA
    n_components = 10
    ica = FastICA(n_components=n_components, random_state=42)
    components_masked = ica.fit_transform(fmri_masked.T).T


.. GENERATED FROM PYTHON SOURCE LINES 67-68

Reverse masking, and display the corresponding map

.. GENERATED FROM PYTHON SOURCE LINES 68-82

.. code-block:: default

    components = nifti_masker.inverse_transform(components_masked)

    # Visualize results
    from nilearn.plotting import plot_stat_map, show
    from nilearn.image import index_img
    from nilearn.image.image import mean_img

    # calculate mean image for the background
    mean_func_img = mean_img(func_filename)

    plot_stat_map(index_img(components, 0), mean_func_img,
                  display_mode='y', cut_coords=4, title="Component 0")

    show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_06_manipulating_images_plot_nifti_simple.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/06_manipulating_images/plot_nifti_simple.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_nifti_simple.py <plot_nifti_simple.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_nifti_simple.ipynb <plot_nifti_simple.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
